# Google Cloud Next’19 in Tokyo 参加記録

## 概要

Google Cloud の最大級のイベント。新製品の発表などもあり、世界中で開催されるイベント。

> Next は Google Cloud に関する技術や事例などを共有するためのイベントです。
> デベロッパー、パートナー、業界の専門家など、
> 様々な方から応募いただいたセッションをお届けします。

※[公式](https://cloud.withgoogle.com/next/tokyo)HPより引用

## Day 1

### 基調講演1

* DeNA
  * 会社設立時、軽んじていたのは、モノづくり
    * 要件定義でだけやって、あとは丸投げ
  * 「経営の言語」と「技術の言語」両方しっかり話せる人材
  * オンプレかクラウドか
    * QCDの内、QとDはほぼ同等に持っていける -> 意見が割れたのはC
      * 「減価償却済みサーバーをこのまま使い続ける前提で比べると、
     今の利用の仕方で全面クラウドシフトすればコストが3倍になるのは事実」
      * 「いかにクラウドで品質を落とさずに低コストで運用できるのか」
      に頭脳と工数を使えば、今のオンプレミスのコスト体系にかなり近づけることができる。
    * 経営者として、決め手になったのは「人材」
      * クラウドで創造的な仕事にフォーカスさせる
* 他
  * GCPを使った色々な事例を各社紹介
  * アプリケーションのモダナイズが重要
  * 大体言ってることは、GCPのインフラを使って、無駄な仕事をせずに関心をドメインにしっかり向けることが大切だと感じた

### Cloud Code とコンテナツールで Kubernetes を使った開発を徹底効率化

* Kubernetesを用いた開発の効率化について
* Cloud Code for VSCodeを用いたdemo (IntelliJ向けの拡張もあり)

### Cloud Run アンチパターン

#### Cloud Runとは

* 「状態を持たないコンテナ」を負荷に応じて自動増減できる環境をGoogleが管理してくれるサービス

#### 特徴

* 任意の言語、フレームワーク、ライブラリが利用できる
* 負荷に応じてオートスケール
* 料金は使った分だけ
* CPUは1コンテナにつき vCPU （それ以上割り当てられない）
* メモリは最大2G

#### 試したこと

* Metabase
  * OSSのデータ可視化ツール
  * jarファイル１つでデプロイできる
  * DockerHubに公開済み
  * ポイントは起動時に色々やる（設定とか）アプリケーション

#### 起きたこと

* Cloud RunではPORT環境変数でリクエストポート設定
  * 公開されているイメージがそのまま使えるとは限らない
* コンテナ終了ログがない
  * Cloud Runではリクエストが来ないと止まる
  * 起動に時間がかかるアプリでは起動する前にコンテナが止まることも(Springとか)
    * 起動中に自動でゼロスケールする
* 起動・停止を繰り返していた
  * 初期セットアップで起動確認リクエストが定期的に送信
  * リクエスト待ち＆初期処理の高負荷 → オートスケール
* JDBCは標準ではTCP/IPコネクションのみサポート

#### まとめ

* 手軽にコンテナを実行できる
* オートスケール/DBとの相性
* 別のサービスも検討対象
  * Cloud Run,GAE FE,clntainer Optimized OS
  * 悩むときはGoogleにきく

### GCP で API 基盤を構築する 〜 API 管理からアーキテクチャまで徹底解説

* 昨今のビジネスにおけるAPIの重要性 -> GCPでAPI基盤を作るには
* Cloud Endpoints とApigee

### GCP における Web アプリケーションのアーキテクチャ定番構成

* 初心者向け
* コンピュートとデータストアの選択肢について大まかな説明

## Day 2

### 基調講演2

* 2日目はGsuitを使った働き方改革の話が多かった印象。
  * ファミマの話とか、IT企業よりIT使ってる気がした。

### ハイブリッド マルチクラウド環境下における Kubernetes デザインの勘所 - データ管理の視点から

* k8sをステートレスに運用するには？
  * 複数cluster(複数cloud)のオペレーションを統合すべき
  * データ永続化レイヤは抽象化して入れ替え可能に
  * コンピュートとデータはアーキテクチャ上分離した方が良い
    * クラウドが良い例（それぞれサービスがあって組み合わせで実現）
* k8s自体の設定?ステート? -> ２種類の考え方をする人がいる
  * 設定としてとらえる場合 -> 自動化の仕組みがないと必ず失敗する
  * ステートとしてとらえる場合 -> マネージドならちゃんとマネージドを理解、それ以外ならちゃんとBKとる

### サーバーレス コンピューティングにおける「次の一手」とは

#### 次の一手は

* サーバレス
  * ソース主導
  * NoOps
  * 使用量に応じて課金
* コンテナ
  * コンテナ主導
  * いくらか（多くの）運用作業
  * インスタンス単位の課金
    * GKE使っても運用はある。
* Cloud Run
  * サーバレスコンテナ
  * サーバレスの考えをコンテナに

#### Cloud Run

* コンテナから本番環境までを数秒で
* ネイティブのサーバレス
  * サーバ管理不要
  * 高速なスケール
* 環境を選ばない一貫したエクスペリエンス

#### Concurrency(同時実行性)による効果

* 他のサーバレスとは違う
  * 従来のサーバレスは１インスタンス１リクエスト
  * VMではできた
* コールドスタートの減少
* 迅速なスケールアップ
* 使用率の向上
